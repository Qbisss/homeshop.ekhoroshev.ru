let i=1;$("#loadMore").on("click",function(t){t.preventDefault();var e=$(this).attr("category"),r=$(this).attr("order"),o=$(this).attr("OrType"),a=`/category/loadmore/${e}/${i}/${r}/${o}`;$.ajax({url:a,method:"GET",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{},success:function(n){n.removeload&&$("#loadMore").remove(),$("#products").append(n.data),i++},error:function(n){console.log(n)}})});$("#sorts").on("click","#sort",function(t){t.preventDefault();var e=$(this).attr("category"),r=$(this).attr("order"),o=$(this).attr("OrType"),a=`/category/sort/${e}/${r}/${o}`;window.location.href=a});$("#items-main").on("click","#fast",function(t){var e=$(this).attr("product"),r=`/category/modal/${e}`;$.ajax({url:r,method:"GET",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{},success:function(o){o.error?($("#modal-body").empty(),$("#modal-body").append(o.error)):($("#fastModalLabel").text(o.name),$("#modal-body").empty(),$("#modal-body").append(o.data))},error:function(o){console.log(o)}})});$("#galaryProduct").on("click","#galaryImage",function(t){t.preventDefault();var e=$(this).attr("src");$(".activeMain").removeClass("activeMain"),$(this).addClass("activeMain"),$("#mainImage").attr("src",e)});$("#items-main").on("click","#addtobasket",function(t){l(t,$(this))});$("#modal-content").on("click","#addtobasket",function(t){l(t,$(this))});function l(t,e){t.preventDefault();var r="/addtobasket",o=e.attr("product");$.ajax({url:r,method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{id:o},success:function(a){a.error||($.toast({text:"Товар добавлен",heading:"Корзина",icon:"success",showHideTransition:"fade",allowToastClose:!0,hideAfter:2e3,stack:3,position:"top-right",textAlign:"left",loader:!0,loaderBg:"#9EC600",beforeShow:function(){},afterShown:function(){},beforeHide:function(){},afterHidden:function(){}}),$("#basketcount").text(a.count))},error:function(a){console.log(a)}})}$('input[id^="basketAmount"]').on("change",function(t){var e=$(this).attr("product"),r=$(this).val(),o=`/basket/productamount/${e}/${r}`;$.ajax({url:o,method:"GET",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{},success:function(a){a.error||($("#price"+e).text(a.price+".00 руб"),$("#basketsum").text("Общая сумма : "+a.sum+".00 руб"))},error:function(a){console.log(a)}})});$('a[id^="delproduct"]').on("click",function(t){t.preventDefault();var e="/deletefrombasket",r=$(this).attr("product");$.ajax({url:e,method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{id:r},success:function(o){o.error||($.toast({text:"Товар убран",heading:"Корзина",icon:"success",showHideTransition:"fade",allowToastClose:!0,hideAfter:2e3,stack:3,position:"top-right",textAlign:"left",loader:!0,loaderBg:"#9EC600",beforeShow:function(){},afterShown:function(){},beforeHide:function(){},afterHidden:function(){}}),$("#trproduct"+r).remove(),$("#basketcount").text(o.count),$("#basketsum").text("Общая сумма : "+o.sum+".00 руб"),o.reload&&window.location.reload())},error:function(o){console.log(o)}})});$("#pickup").on("click",function(t){$("#orderForm").empty(),$("#orderForm").append('<form id="formDelivery"> <p class="mb-3"> При самовывозе товар бранируется на срок не более 2 дней!</p><div class="mb-3"><label for="FullName" class="form-label">Фамилия Имя Отчество</label><input type="text" class="form-control" id="FullName" name="fullName"><div id="FullName" class="form-text">ФИО через пробел</div></div><div class="mb-3"><label for="FullName" class="form-label">Номер телефона</label><input type="text" class="form-control bfh-phone" id="Phone" name="phone" data-format="+7 (ddd) ddd-dd-dd"><div id="FullName" class="form-text"></div></div> <input type="hidden" name="delivery" value="Самовывоз"> <input type="hidden" name="address" value=" Москва, Кировоградская ул., 13А, тц. Columbus">  <button type="submit" id="btn-delivery" class="btn btn-primary">Заказать</button></form>')});$("#deliverybtn").on("click",function(t){$("#orderForm").empty(),$("#orderForm").append('<form id="formDelivery"><p class="mb-3">После оформелния заказа с вами свяжется наш оператор и скажет цену доставки, после Вам будем выставлен счет на оплату</p><div class="mb-3"><label for="fullName" class="form-label">Фамилия Имя Отчество</label><input type="text" class="form-control" id="fullName" name="fullName"><div id="fullName" class="form-text">ФИО через пробел</div></div><select class="form-select mb-3" name="delivery"><option value="no" selected>Выберите способ доставки</option><option value="Сдэк">Сдэк</option><option value="Почта России">Почта России</option><option value="Яндекс доставка">Яндекс доставка</option></select><div class="mb-3"><label for="address" class="form-label">Адрес доставки</label><input type="text" class="form-control" id="address" name="address"><div id="addressS" class="form-text">Город, улица, дом, квартира или адрес пункта выдачи</div></div><div class="mb-3"><label for="phone" class="form-label">Номер телефона</label><input type="text" class="form-control bfh-phone mb-3" id="phone" name="phone" data-format="+1 (ddd) ddd-dddd"> </div> <button type="submit" id="btn-delivery" class="btn btn-primary">Заказать</button></form>')});$("#btnSearch").on("click",function(t){var e=$("#search").val(),r=`/search/${e}`;e&&(window.location.href=r)});$("#orderForm").on("click","#btn-delivery",function(t){t.preventDefault();var e=window.location.href+"/add_order",r=new FormData,o=$("#formDelivery").serializeArray();$.each(o,function(a,n){r.append(n.name,n.value)}),$.ajax({url:e,method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:r,processData:!1,contentType:!1,success:function(a){if(a.error){$.toast({text:a.error,heading:"Ошибка",icon:"error",showHideTransition:"fade",allowToastClose:!0,hideAfter:3e3,stack:3,position:"top-right",textAlign:"left",loader:!0,loaderBg:"#9EC600",beforeShow:function(){},afterShown:function(){},beforeHide:function(){},afterHidden:function(){}});return}console.log(a.redirect_url),a.redirect_url&&(window.location.href=a.redirect_url)},error:function(a){console.log(a)}})});function d(){var t=$(window).height(),e=$("footer").outerHeight(!0),r=$("main").outerHeight(!0)-$("main").height()+3;$("main").css({"min-height":t-e-r})}d();$(window).resize(function(){d()});document.addEventListener("DOMContentLoaded",function(t){var e=localStorage.getItem("curPage"),r=localStorage.getItem("scrollpos");r&&e==window.location.pathname?window.scrollTo(0,r):(window.location.pathname.includes("product")||window.location.pathname.includes("category"))&&document.getElementById("items-main").scrollIntoView()});window.onbeforeunload=function(t){localStorage.setItem("scrollpos",window.scrollY),localStorage.setItem("curPage",window.location.pathname)};
